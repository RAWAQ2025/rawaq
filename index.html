<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<title>Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø­Ø¬ÙˆØ²Ø§Øª</title>

<style>
body {
  font-family: Arial;
  background: #f5f5f5;
  padding: 20px;
}

h2 {
  text-align: center;
}

form, table {
  background: white;
  padding: 15px;
  border-radius: 8px;
  margin-bottom: 20px;
}

label {
  font-weight: bold;
  display: block;
  margin-top: 10px;
}

input, select, button {
  width: 100%;
  padding: 8px;
  margin-top: 5px;
}

button {
  background: #2563eb;
  color: white;
  border: none;
  cursor: pointer;
  margin-top: 10px;
}

#drinkList span {
  background: #ddd;
  padding: 5px 8px;
  border-radius: 4px;
  margin: 3px;
  display: inline-block;
  cursor: pointer;
}

table {
  width: 100%;
  border-collapse: collapse;
  font-size: 14px;
}

th, td {
  border: 1px solid #ccc;
  padding: 6px;
  text-align: center;
}

th {
  background: #eee;
}

.red { background: #fca5a5; }
.yellow { background: #fde68a; }
.green { background: #bbf7d0; }
.done { opacity: 0.5; text-decoration: line-through; }
</style>
</head>

<body>

<h2>Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø­Ø¬ÙˆØ²Ø§Øª</h2>

<form id="form">

<label>Ø§Ø³Ù… Ø§Ù„Ø¹Ù…ÙŠÙ„</label>
<input id="name" required>

<label>Ø±Ù‚Ù… Ø§Ù„Ø¬ÙˆØ§Ù„</label>
<input id="phone" required>

<label>ØªØ§Ø±ÙŠØ® Ø§Ù„Ø­Ø¬Ø²</label>
<input type="date" id="bookingDate" required>

<label>ØªØ§Ø±ÙŠØ® Ø§Ù„Ù…Ù†Ø§Ø³Ø¨Ø©</label>
<input type="date" id="eventDate" required>

<label>Ø§Ù„Ù…Ø´Ø±ÙˆØ¨Ø§Øª</label>
<select id="drinkSelect">
  <option value="">Ø§Ø®ØªØ± Ù…Ø´Ø±ÙˆØ¨</option>
  <option>Ù‡ÙˆØª Ø´ÙˆÙƒÙ„Øª</option>
  <option>Ø³Ø­Ù„Ø¨</option>
  <option>ÙƒØ±Ùƒ</option>
  <option>ÙƒØ§Ø³ØªØ±Ø¯</option>
  <option>Ù‚Ù‡ÙˆØ© Ø§Ù„Ù„ÙˆØ²</option>
  <option>Ù‚Ù‡ÙˆØ© Ø¹Ø±Ø¨ÙŠØ©</option>
  <option>Ø´Ø§Ù‡ÙŠ Ø£Ø­Ù…Ø±</option>
  <option>ØªÙ…Ø± Ù…Ø­Ø´ÙŠ</option>
  <option>Ù…Ø¹Ù…ÙˆÙ„</option>
</select>

<button type="button" onclick="addDrink()">â• Ø¥Ø¶Ø§ÙØ© Ù…Ø´Ø±ÙˆØ¨</button>
<div id="drinkList"></div>

<label>Ø§Ù„Ø¹Ø±Ø¨Ø©</label>
<select id="cart" required>
  <option value="">Ø§Ø®ØªØ± Ø§Ù„Ø¹Ø±Ø¨Ø©</option>
  <option>ÙƒØ¨ÙŠØ±Ø©</option>
  <option>ÙˆØ³Ø·</option>
  <option>ØµØºÙŠØ±Ø©</option>
  <option>ÙˆØ³Ø· ÙˆØµØºÙŠØ±Ø©</option>
</select>

<label>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„ÙØ§ØªÙˆØ±Ø©</label>
<input type="number" id="total" required>

<label>Ø§Ù„Ø®ØµÙ…</label>
<input type="number" id="discount" value="0">

<label>Ø§Ù„Ø¹Ø±Ø¨ÙˆÙ†</label>
<input type="number" id="deposit" value="0">

<label>Ø§Ù„ØªØ£Ù…ÙŠÙ†</label>
<input type="number" id="insurance" value="0">

<button type="submit">ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø­Ø¬Ø²</button>

</form>

<table>
<thead>
<tr>
<th>Ø§Ù„Ø¹Ù…ÙŠÙ„</th>
<th>Ø§Ù„Ø¬ÙˆØ§Ù„</th>
<th>ØªØ§Ø±ÙŠØ® Ø§Ù„Ø­Ø¬Ø²</th>
<th>ØªØ§Ø±ÙŠØ® Ø§Ù„Ù…Ù†Ø§Ø³Ø¨Ø©</th>
<th>Ø§Ù„Ø¹Ø±Ø¨Ø©</th>
<th>Ø§Ù„Ù…Ø´Ø±ÙˆØ¨Ø§Øª</th>
<th>Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ</th>
<th>Ø§Ù„Ø®ØµÙ…</th>
<th>Ø§Ù„ØµØ§ÙÙŠ</th>
<th>Ø§Ù„Ø¹Ø±Ø¨ÙˆÙ†</th>
<th>Ø§Ù„ØªØ£Ù…ÙŠÙ†</th>
<th>ØªÙ…Øª Ø§Ù„Ø®Ø¯Ù…Ø©</th>
<th>ÙØ§ØªÙˆØ±Ø©</th>
</tr>
</thead>
<tbody id="tbody"></tbody>
</table>

<script>
let bookings = [];
let drinks = [];

function addDrink() {
  if (!drinkSelect.value) return;
  drinks.push(drinkSelect.value);
  renderDrinks();
  drinkSelect.value = "";
}

function renderDrinks() {
  drinkList.innerHTML = "";
  drinks.forEach((d,i)=>{
    drinkList.innerHTML += <span onclick="removeDrink(${i})">${d} âœ–</span>;
  });
}

function removeDrink(i){
  drinks.splice(i,1);
  renderDrinks();
}

function rowColor(date){
  const diff = Math.ceil((new Date(date)-new Date())/86400000);
  if(diff <= 2) return "red";
  if(diff <= 5) return "yellow";
  return "green";
}

form.onsubmit = e => {
  e.preventDefault();

  if(drinks.length === 0){
    alert("Ø§Ø®ØªØ± Ù…Ø´Ø±ÙˆØ¨ ÙˆØ§Ø­Ø¯ Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„");
    return;
  }

  if(bookings.find(b => b.eventDate === eventDate.value && b.cart === cart.value)){
    alert("âš ï¸ Ø§Ù„Ø¹Ø±Ø¨Ø© Ù…Ø­Ø¬ÙˆØ²Ø© ÙÙŠ Ù‡Ø°Ø§ Ø§Ù„ØªØ§Ø±ÙŠØ®");
    return;
  }

  const finalTotal = total.value - discount.value;

  bookings.push({
    name: name.value,
    phone: phone.value,
    bookingDate: bookingDate.value,
    eventDate: eventDate.value,
    cart: cart.value,
    drinks: drinks.join("ØŒ "),
    total: total.value,
    discount: discount.value,
    finalTotal,
    deposit: deposit.value,
    insurance: insurance.value,
    done: false
  });

  bookings.sort((a,b)=>new Date(a.eventDate)-new Date(b.eventDate));
  renderTable();

  form.reset();
  drinks=[];
  renderDrinks();
};

function renderTable(){
  tbody.innerHTML="";
  bookings.forEach((b,i)=>{
    tbody.innerHTML += `
    <tr class="${rowColor(b.eventDate)} ${b.done?'done':''}">
      <td>${b.name}</td>
      <td>${b.phone}</td>
      <td>${b.bookingDate}</td>
      <td>${b.eventDate}</td>
      <td>${b.cart}</td>
      <td>${b.drinks}</td>
      <td>${b.total}</td>
      <td>${b.discount}</td>
      <td>${b.finalTotal}</td>
      <td>${b.deposit}</td>
      <td>${b.insurance}</td>
      <td><input type="checkbox" onchange="toggleDone(${i})"></td>
      <td><button onclick="printRow(this)">ğŸ–¨ï¸</button></td>
    </tr>`;
  });
}

function toggleDone(i){
  bookings[i].done = !bookings[i].done;
  renderTable();
}

function printRow(btn){
  const row = btn.closest("tr").outerHTML;
  const win = window.open("");
  win.document.write("<table border='1'>"+row+"</table>");
  win.print();
}
</script>

</body>
</html>
