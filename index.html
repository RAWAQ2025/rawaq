<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8">
<title>إدارة الحجوزات</title>

<style>
body {
    font-family: Tahoma;
    direction: rtl;
    background: #f5f5f5;
    padding: 20px;
}

.container {
    background: #fff;
    padding: 20px;
    border-radius: 6px;
}

input, select, button {
    width: 100%;
    padding: 8px;
    margin: 5px 0;
}

button {
    background: #1e3cff;
    color: #fff;
    border: none;
    cursor: pointer;
}

button:hover {
    opacity: 0.9;
}

table {
    width: 100%;
    border-collapse: collapse;
    margin-top: 20px;
}

th, td {
    border: 1px solid #ccc;
    padding: 6px;
    text-align: center;
}

th {
    background: #ddd;
}

.green { background: #c8f7c5; }
.yellow { background: #fff3b0; }
.red { background: #f7c5c5; }
</style>
</head>

<body>

<div class="container">
<h2>إدارة الحجوزات</h2>

<label>اسم العميل</label>
<input id="name">

<label>رقم الجوال</label>
<input id="phone">

<label>تاريخ الحجز</label>
<input type="date" id="bookDate">

<label>تاريخ التنفيذ</label>
<input type="date" id="eventDate">

<label>نوع العربة</label>
<select id="cart">
    <option value="">اختر</option>
    <option>كبيرة</option>
    <option>وسط</option>
    <option>صغيرة</option>
    <option>وسط وصغيرة</option>
</select>

<hr>

<h3>المشروبات</h3>

<select id="drink">
    <option value="">اختر مشروب</option>
    <option value="10">قهوة (10)</option>
    <option value="15">لاتيه (15)</option>
    <option value="12">كابتشينو (12)</option>
</select>

<input type="number" id="qty" placeholder="الكمية" value="1">

<button onclick="addDrink()">➕ إضافة مشروب</button>

<ul id="drinkList"></ul>

<hr>

<label>الخصم</label>
<input type="number" id="discount" value="0">

<label>العربون</label>
<input type="number" id="deposit" value="0">

<button onclick="addBooking()">تأكيد الحجز</button>

<table>
<thead>
<tr>
<th>الاسم</th>
<th>الجوال</th>
<th>العربة</th>
<th>المشروبات</th>
<th>الإجمالي</th>
<th>الخصم</th>
<th>الصافي</th>
</tr>
</thead>
<tbody id="tableBody"></tbody>
</table>

</div>

<script>
let drinks = [];
let reservedCarts = [];

function addDrink() {
    let drink = document.getElementById("drink");
    let qty = document.getElementById("qty").value;

    if (!drink.value) {
        alert("اختر مشروب");
        return;
    }

    drinks.push({
        name: drink.options[drink.selectedIndex].text,
        price: Number(drink.value),
        qty: Number(qty)
    });

    renderDrinks();
}

function renderDrinks() {
    let ul = document.getElementById("drinkList");
    ul.innerHTML = "";
    drinks.forEach(d => {
        ul.innerHTML += <li>${d.name} × ${d.qty}</li>;
    });
}

function addBooking() {
    let name = document.getElementById("name").value;
    let phone = document.getElementById("phone").value;
    let cart = document.getElementById("cart").value;
    let discount = Number(document.getElementById("discount").value);
    let deposit = Number(document.getElementById("deposit").value);

    if (!name || !cart || drinks.length === 0) {
        alert("أكمل البيانات");
        return;
    }

    if (reservedCarts.includes(cart)) {
        alert("⚠️ العربة محجوزة");
        return;
    }

    let total = drinks.reduce((s,d)=>s+(d.price*d.qty),0);
    let net = total - discount - deposit;

    let rowColor = net < 0 ? "red" : discount > 0 ? "yellow" : "green";

    document.getElementById("tableBody").innerHTML += `
    <tr class="${rowColor}">
        <td>${name}</td>
        <td>${phone}</td>
        <td>${cart}</td>
        <td>${drinks.map(d=>${d.name}×${d.qty}).join("<br>")}</td>
        <td>${total}</td>
        <td>${discount}</td>
        <td>${net}</td>
    </tr>`;

    reservedCarts.push(cart);
    drinks = [];
    renderDrinks();
}
</script>

</body>
</html>
