<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>الطلبات المنجزة - رواق</title>

<style>
:root{
  --purple:#4b1f5c;
  --bg:#f4f1f6;
}
body{margin:0;font-family:Tahoma;background:var(--bg);}
.container{max-width:95%;margin:20px auto;background:#fff;padding:15px;border-radius:12px;}
h2{text-align:center;color:var(--purple);}
table{width:100%;border-collapse:collapse;margin-top:15px;font-size:14px;}
th,td{border:1px solid #ddd;padding:8px;text-align:center;vertical-align:top;}
th{background:var(--purple);color:#fff;}
.client{line-height:1.6}
.back{margin-top:15px;width:100%;padding:12px;border:none;border-radius:10px;cursor:pointer}
.empty{text-align:center;margin-top:20px;color:#777}
</style>
</head>

<body>

<div class="container">
  <h2>الطلبات المنجزة</h2>

  <table>
    <thead>
      <tr>
        <th>#</th>
        <th>العميل</th>
        <th>تاريخ المناسبة</th>
        <th>المشروبات</th>
        <th>العربة</th>
        <th>العربون / التأمين</th>
        <th>الصافي</th>
      </tr>
    </thead>
    <tbody id="body"></tbody>
  </table>

  <div id="empty" class="empty" style="display:none">
    لا توجد طلبات منجزة
  </div>

  <button class="back" onclick="location.href='index.html'">العودة</button>
</div>

<script>
const API_URL = "ضع_رابط_exec_هنا";

function formatDate(d){
  if(!d) return "";
  return new Date(d).toLocaleDateString("ar-SA");
}

/* تحميل الطلبات المنجزة */
fetch(API_URL)
  .then(r => r.json())
  .then(data => {
    const body  = document.getElementById("body");
    const empty = document.getElementById("empty");
    body.innerHTML = "";

    const doneOrders = data.filter(o => o.status === "تم");

    if (doneOrders.length === 0) {
      empty.style.display = "block";
      return;
    }

    doneOrders.forEach((o,i)=>{
      body.innerHTML += `
        <tr>
          <td>${i+1}</td>
          <td class="client">
            ${o.name || ""}<br>
            ${o.phone || ""}
          </td>
          <td>${formatDate(o.eventDate)}</td>
          <td>${o.drinks || ""}</td>
          <td>${o.cart || ""}</td>
          <td>
            عربون: ${o.deposit || 0}<br>
            تأمين: ${o.insurance || 0}
          </td>
          <td>${o.net || 0}</td>
        </tr>
      `;
    });
  })
  .catch(()=>{
    document.getElementById("empty").style.display = "block";
  });
</script>

</body>
</html>
