<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>عرض الطلبات - رواق</title>

<style>
body{margin:0;font-family:Tahoma;background:#f4f1f6;}
.container{max-width:95%;margin:20px auto;background:#fff;padding:15px;border-radius:12px;}
h2{text-align:center;color:#4b1f5c;}
table{width:100%;border-collapse:collapse;margin-top:15px;}
th,td{border:1px solid #ddd;padding:8px;text-align:center;}
th{background:#4b1f5c;color:#fff;}
.btn{padding:5px 8px;border:none;border-radius:6px;font-size:12px;cursor:pointer;margin:2px;}
.done{background:#4b1f5c;color:#fff;}
.edit{background:#ffc107;}
.delete{background:#dc3545;color:#fff;}
.back-btn{margin-top:15px;width:100%;padding:12px;background:#ddd;color:#4b1f5c;border:none;border-radius:10px;}
</style>
</head>

<body>
<div class="container">
<h2>عرض الطلبات</h2>

<table>
<thead>
<tr>
<th>#</th>
<th>العميل</th>
<th>تاريخ المناسبة</th>
<th>المشروبات</th>
<th>الصافي</th>
<th>إجراءات</th>
</tr>
</thead>
<tbody id="tableBody"></tbody>
</table>

<button class="back-btn" onclick="location.href='index.html'">العودة</button>
</div>

<script>
let orders=JSON.parse(localStorage.getItem("orders")||"[]");
const body=document.getElementById("tableBody");
let c=1;

orders.forEach((o,i)=>{
  if(o.status==="جديد"){
    body.innerHTML+=`
      <tr>
        <td>${c++}</td>
        <td>${o.name||""}<div style="font-size:12px;color:#555">${o.phone||""}</div></td>
        <td>${o.eventDate||""}</td>
        <td>${o.drinks||""}</td>
        <td>${o.net||0}</td>
        <td>
          <button class="btn done" onclick="markDone(${i})">تمت الخدمة</button>
          <button class="btn edit" onclick="editOrder(${i})">تعديل</button>
          <button class="btn delete" onclick="deleteOrder(${i})">حذف</button>
        </td>
      </tr>`;
  }
});

function editOrder(i){
  localStorage.setItem("editIndex",i);
  location.href="add.html";
}
function deleteOrder(i){
  if(confirm("حذف الطلب؟")){
    orders.splice(i,1);
    localStorage.setItem("orders",JSON.stringify(orders));
    location.reload();
  }
}
function markDone(i){
  orders[i].status="تم";
  localStorage.setItem("orders",JSON.stringify(orders));
  location.href="completed.html";
}
</script>

</body>
</html>
