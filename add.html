<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>تسجيل طلب جديد - رواق</title>

<style>
body{
  font-family:Tahoma;
  background:#f4f1f6;
  margin:0;
}
.container{
  max-width:600px;
  margin:30px auto;
  background:#fff;
  padding:20px;
  border-radius:12px;
}
h2{ text-align:center; color:#4b1f5c; }
label{ display:block; margin-top:12px; font-weight:bold; }
input,select{
  width:100%; padding:10px; margin-top:6px;
  border-radius:8px; border:1px solid #ccc;
}
button{
  width:100%; margin-top:15px; padding:12px;
  background:#4b1f5c; color:#fff;
  border:none; border-radius:10px;
  font-size:16px;
}
ul{ padding-right:20px; }
li{ display:flex; justify-content:space-between; }
.remove{ background:none; border:none; color:red; }
</style>
</head>

<body>
<div class="container">
<h2>تسجيل طلب جديد</h2>

<label>اسم العميل</label>
<input id="name">

<label>رقم الجوال</label>
<input id="phone">

<label>تاريخ الحجز</label>
<input type="date" id="bookingDate">

<label>تاريخ المناسبة</label>
<input type="date" id="eventDate">

<label>المشروبات</label>
<select id="drinkSelect">
  <option value="">اختر</option>
  <option>هوت شوكلت</option>
  <option>سحلب</option>
  <option>كرك</option>
  <option>قهوة عربية</option>
</select>
<button onclick="addDrink()">إضافة مشروب</button>
<ul id="drinkList"></ul>

<label>العربة</label>
<select id="cart">
  <option value="">اختر</option>
  <option>كبيرة</option>
  <option>وسط</option>
  <option>صغيرة</option>
</select>

<label>التأمين</label>
<input type="number" id="insurance" value="0">

<label>العربون</label>
<input type="number" id="deposit" value="0" oninput="calc()">

<label>الإجمالي</label>
<input type="number" id="total" value="0" oninput="calc()">

<label>الخصم</label>
<input type="number" id="discount" value="0" oninput="calc()">

<p>الصافي: <strong id="net">0</strong></p>

<button onclick="saveOrder()">حفظ الطلب</button>
</div>

<script>
const SHEET_URL = "https://script.google.com/macros/s/AKfycbybvabnb_dGz4jQBmK5pasaO2k0UK4e_hfGLroQT9uC-4MRfZygnmudaz9TSbo1zC4r/exec";

let drinks=[];

function addDrink(){
  if(!drinkSelect.value) return;
  drinks.push(drinkSelect.value);
  render();
}

function render(){
  drinkList.innerHTML="";
  drinks.forEach((d,i)=>{
    drinkList.innerHTML+=`<li>${d}<button class="remove" onclick="del(${i})">✖</button></li>`;
  });
}

function del(i){
  drinks.splice(i,1); render();
}

function calc(){
  net.textContent = Math.max(
    (total.value||0) - (discount.value||0) - (deposit.value||0),
    0
  );
}

function saveOrder(){
  const order={
    name:name.value,
    phone:phone.value,
    bookingDate:bookingDate.value,
    eventDate:eventDate.value,
    drinks:drinks,
    cart:cart.value,
    insurance:insurance.value,
    deposit:deposit.value,
    total:total.value,
    discount:discount.value,
    net:net.textContent,
    status:"جديد"
  };

  fetch(SHEET_URL,{
    method:"POST",
    body:JSON.stringify(order)
  })
  .then(()=>alert("تم حفظ الطلب ✅"))
  .catch(()=>alert("فشل الإرسال ❌"));
}
</script>
</body>
</html>
