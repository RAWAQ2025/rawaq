<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ØªØ³Ø¬ÙŠÙ„ Ø·Ù„Ø¨ Ø¬Ø¯ÙŠØ¯ - Ø±ÙˆØ§Ù‚</title>

<style>
:root{
  --purple:#4b1f5c;
  --bg:#f4f1f6;
}
body{
  margin:0;
  font-family:Tahoma, Arial;
  background:var(--bg);
}
.container{
  max-width:600px;
  margin:30px auto;
  background:#fff;
  padding:20px;
  border-radius:12px;
}
h2{
  text-align:center;
  color:var(--purple);
}
label{
  display:block;
  margin-top:12px;
  font-weight:bold;
}
input, select{
  width:100%;
  padding:10px;
  margin-top:6px;
  border-radius:8px;
  border:1px solid #ccc;
}
.row{
  display:flex;
  gap:10px;
}
.row > div{ flex:1; }
.drink-box{
  display:flex;
  gap:10px;
  margin-top:6px;
}
.add-btn{
  background:var(--purple);
  color:#fff;
  border:none;
  border-radius:8px;
  padding:0 14px;
  font-size:20px;
  cursor:pointer;
}
ul{
  margin-top:10px;
  padding-right:18px;
}
ul li{
  display:flex;
  justify-content:space-between;
  margin-bottom:5px;
}
.remove{
  background:none;
  border:none;
  color:#b00020;
  cursor:pointer;
}
.total-box{
  background:#eee8f0;
  padding:10px;
  border-radius:8px;
  margin-top:12px;
}
.save-btn, .back-btn, .pass-btn{
  width:100%;
  margin-top:12px;
  padding:12px;
  font-size:16px;
  border:none;
  border-radius:10px;
  cursor:pointer;
}
.save-btn{ background:var(--purple); color:#fff; }
.back-btn{ background:#ddd; color:var(--purple); }
.pass-btn{ background:#222; color:#fff; }
.success{
  display:none;
  text-align:center;
  margin-top:15px;
  color:green;
}
</style>
</head>

<body>

<div class="container">
<h2>ØªØ³Ø¬ÙŠÙ„ Ø·Ù„Ø¨ Ø¬Ø¯ÙŠØ¯</h2>

<label>Ø§Ø³Ù… Ø§Ù„Ø¹Ù…ÙŠÙ„</label>
<input id="name">

<label>Ø±Ù‚Ù… Ø§Ù„Ø¬ÙˆØ§Ù„</label>
<input id="phone">

<div class="row">
  <div>
    <label>ØªØ§Ø±ÙŠØ® Ø§Ù„Ø­Ø¬Ø²</label>
    <input type="date" id="bookingDate">
  </div>
  <div>
    <label>ØªØ§Ø±ÙŠØ® Ø§Ù„Ù…Ù†Ø§Ø³Ø¨Ø©</label>
    <input type="date" id="eventDate">
  </div>
</div>

<label>Ø§Ù„Ù…Ø´Ø±ÙˆØ¨Ø§Øª</label>
<div class="drink-box">
  <select id="drinkSelect">
    <option value="">Ø§Ø®ØªØ± Ø§Ù„Ù…Ø´Ø±ÙˆØ¨</option>
    <option>Ù‡ÙˆØª Ø´ÙˆÙƒÙ„Øª</option>
    <option>Ø³Ø­Ù„Ø¨</option>
    <option>ÙƒØ±Ùƒ</option>
    <option>Ù‚Ù‡ÙˆØ© Ø§Ù„Ù„ÙˆØ²</option>
    <option>Ù‚Ù‡ÙˆØ© Ø¹Ø±Ø¨ÙŠØ©</option>
  </select>
  <button class="add-btn" onclick="addDrink()">+</button>
</div>

<ul id="drinkList"></ul>

<label>Ø§Ù„Ø¹Ø±Ø¨Ø©</label>
<select id="cart">
  <option value="">Ø§Ø®ØªØ±</option>
  <option>ÙƒØ¨ÙŠØ±Ø©</option>
  <option>ÙˆØ³Ø·</option>
  <option>ØµØºÙŠØ±Ø©</option>
</select>

<label>Ø§Ù„ØªØ£Ù…ÙŠÙ†</label>
<input type="number" id="insurance" value="0">

<label>Ø§Ù„Ø¹Ø±Ø¨ÙˆÙ†</label>
<input type="number" id="depositInput" value="0" oninput="updateNet()">

<label>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„ÙØ§ØªÙˆØ±Ø©</label>
<input type="number" id="totalInput" value="0" oninput="updateNet()">

<label>Ø§Ù„Ø®ØµÙ…</label>
<input type="number" id="discountInput" value="0" oninput="updateNet()">

<div class="total-box">
Ø§Ù„ØµØ§ÙÙŠ: <strong id="net">0</strong>
</div>

<button class="save-btn" onclick="saveOrder()">Ø­ÙØ¸ Ø§Ù„Ø·Ù„Ø¨</button>
<button class="pass-btn" onclick="changePassword()">ØªØºÙŠÙŠØ± ÙƒÙ„Ù…Ø© Ø§Ù„Ø³Ø±</button>
<button class="back-btn" onclick="logout()">ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬</button>

<div class="success" id="successMsg">ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø·Ù„Ø¨ Ø¨Ù†Ø¬Ø§Ø­ âœ…</div>
</div>

<script>
const SHEET_URL = "https://script.google.com/macros/s/AKfycbwvVoy69UT6uCzHdUjLYomzYBMIFZeeEL_ipU8sqV-xd-txf7WSK-bdXjssu4hRVZ2x/exec";

let drinks = [];

function addDrink(){
  if(!drinkSelect.value) return;
  drinks.push(drinkSelect.value);
  renderDrinks();
  drinkSelect.value="";
}

function renderDrinks(){
  drinkList.innerHTML="";
  drinks.forEach((d,i)=>{
    drinkList.innerHTML += `
      <li>${d}
        <button class="remove" onclick="removeDrink(${i})">âœ–</button>
      </li>`;
  });
}

function removeDrink(i){
  drinks.splice(i,1);
  renderDrinks();
}

function updateNet(){
  net.textContent = Math.max(
    (+totalInput.value||0) -
    (+discountInput.value||0) -
    (+depositInput.value||0)
  ,0);
}

function saveOrder(){
  const nameEl = document.getElementById("name");
  const phoneEl = document.getElementById("phone");

  if(!nameEl.value.trim() || !phoneEl.value.trim()){
    alert("Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ø³Ù… Ø§Ù„Ø¹Ù…ÙŠÙ„ ÙˆØ±Ù‚Ù… Ø§Ù„Ø¬ÙˆØ§Ù„");
    return;
  }

  const order = {
    name: nameEl.value,
    phone: phoneEl.value,
    bookingDate: bookingDate.value,
    eventDate: eventDate.value,
    drinks: drinks.join("ØŒ "),
    cart: cart.value,
    insurance: insurance.value,
    deposit: depositInput.value,
    total: totalInput.value,
    discount: discountInput.value,
    net: net.textContent,
    status: "Ø¬Ø¯ÙŠØ¯"
  };

  fetch(SHEET_URL,{
    method:"POST",
    headers:{ "Content-Type":"application/json" },
    body:JSON.stringify(order)
  })
  .then(()=>{
    successMsg.style.display="block";
    setTimeout(()=>successMsg.style.display="none",2000);
  })
  .catch(()=>alert("Ø­ØµÙ„ Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„"));
}

/* ğŸ” ØªØºÙŠÙŠØ± ÙƒÙ„Ù…Ø© Ø§Ù„Ø³Ø± */
function changePassword(){
  const newPass = prompt("Ø£Ø¯Ø®Ù„ ÙƒÙ„Ù…Ø© Ø§Ù„Ø³Ø± Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©");
  if(!newPass) return;
  localStorage.setItem("password", newPass);
  alert("ØªÙ… ØªØºÙŠÙŠØ± ÙƒÙ„Ù…Ø© Ø§Ù„Ø³Ø±ØŒ Ø³ÙŠØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬");
  logout();
}

/* ğŸšª ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬ */
function logout(){
  localStorage.removeItem("loggedIn");
  location.href = "login.html";
}
</script>

</body>
</html>
